{
  "entities": {
    "achievement": {
      "title": "Achievement",
      "description": "Represents a user's progress on a specific achievement.",
      "type": "object",
      "properties": {
        "id": { "type": "string", "description": "The unique identifier for the achievement." },
        "isUnlocked": { "type": "boolean", "description": "Whether the user has unlocked this achievement." },
        "progress": { "type": "number", "description": "The user's current progress towards the achievement." },
        "unlockedAt": { "type": "string", "format": "date-time", "description": "The timestamp when the achievement was unlocked." }
      },
      "required": ["id", "isUnlocked", "progress"]
    },
    "userStats": {
      "title": "User Statistics",
      "description": "Stores aggregated game statistics for a user.",
      "type": "object",
      "properties": {
        "highScore": { "type": "number", "description": "The user's highest score achieved in any game." },
        "gamesPlayed": { "type": "number", "description": "The total number of games the user has played." },
        "totalScore": { "type": "number", "description": "The cumulative score across all games played." },
        "neonBits": { "type": "number", "description": "The amount of in-game currency the user has." },
        "equippedCosmetic": { "type": "string", "description": "The ID of the cosmetic the user has equipped." },
        "nestId": { "type": "string", "description": "The ID of the Nest the user is a member of."},
        "leaguePoints": { "type": "number", "description": "The user's points for the competitive league."},
        "lastSeasonClaimed": { "type": "string", "description": "Identifier for the last season rewards were claimed, e.g., '2024-10'." }
      },
      "required": []
    },
    "leaguePlayer": {
        "title": "League Player",
        "description": "Publicly queryable data for a player in the league.",
        "type": "object",
        "properties": {
            "userId": { "type": "string" },
            "username": { "type": "string" },
            "leaguePoints": { "type": "number" },
            "equippedCosmetic": { "type": "string" }
        },
        "required": ["userId", "username", "leaguePoints", "equippedCosmetic"]
    },
    "cosmetic": {
        "title": "Cosmetic",
        "description": "Represents a cosmetic item a user has unlocked.",
        "type": "object",
        "properties": {
            "id": { "type": "string", "description": "The unique identifier for the cosmetic." },
            "unlockedAt": { "type": "string", "format": "date-time", "description": "The timestamp when the cosmetic was unlocked." }
        },
        "required": ["id", "unlockedAt"]
    },
    "nest": {
      "title": "Nest",
      "description": "Represents a clan or group of players.",
      "type": "object",
      "properties": {
        "name": { "type": "string", "description": "The name of the Nest." },
        "motto": { "type": "string", "description": "A short description or motto for the Nest." },
        "emblemId": { "type": "string", "description": "The ID for the Nest's chosen emblem." },
        "isPublic": { "type": "boolean", "description": "If true, players can join without approval." },
        "ownerId": { "type": "string", "description": "The UID of the player who created the Nest." },
        "memberCount": { "type": "number", "description": "The number of members in the Nest." },
        "totalScore": { "type": "number", "description": "The cumulative score of all members." }
      },
      "required": ["name", "isPublic", "ownerId"]
    },
    "nestMember": {
      "title": "Nest Member",
      "description": "Represents a user's membership and role within a Nest.",
      "type": "object",
      "properties": {
        "userId": { "type": "string", "description": "The UID of the user." },
        "username": { "type": "string", "description": "The display name of the user." },
        "role": { "type": "string", "enum": ["admin", "moderator", "member"], "description": "The role of the user in the Nest." },
        "joinedAt": { "type": "string", "format": "date-time", "description": "The timestamp when the user joined." },
        "leaguePoints": { "type": "number", "description": "The league points of the member, denormalized for sorting." }
      },
      "required": ["userId", "username", "role", "joinedAt"]
    },
    "nestJoinRequest": {
        "title": "Nest Join Request",
        "description": "Represents a user's request to join a private Nest.",
        "type": "object",
        "properties": {
            "nestId": { "type": "string" },
            "userId": { "type": "string" },
            "username": { "type": "string" },
            "status": { "type": "string", "enum": ["pending", "approved", "rejected"] },
            "requestedAt": { "type": "string", "format": "date-time" }
        },
        "required": ["nestId", "userId", "username", "status", "requestedAt"]
    },
    "chatMessage": {
      "title": "Chat Message",
      "description": "A message in any chat channel.",
      "type": "object",
      "properties": {
        "userId": { "type": "string", "description": "The UID of the user who sent the message." },
        "username": { "type": "string", "description": "The display name of the user." },
        "text": { "type": "string", "description": "The content of the message." },
        "timestamp": { "type": "string", "format": "date-time", "description": "The time the message was sent." }
      },
      "required": ["userId", "username", "text", "timestamp"]
    },
    "conversation": {
        "title": "Conversation Pointer",
        "description": "A document indicating that a user has a conversation with another user.",
        "type": "object",
        "properties": {
            "userId": { "type": "string" },
            "username": { "type": "string" },
            "lastMessageAt": { "type": "string", "format": "date-time" }
        },
        "required": ["userId", "username", "lastMessageAt"]
    },
    "username": {
      "title": "Username",
      "description": "A registry document to ensure username uniqueness. The document ID is the lowercase username.",
      "type": "object",
      "properties": {
        "userId": { "type": "string", "description": "The UID of the user who owns this username." }
      },
      "required": ["userId"]
    },
    "nestName": {
      "title": "Nest Name",
      "description": "A registry document to ensure Nest name uniqueness. The document ID is the lowercase Nest name.",
      "type": "object",
      "properties": {
        "nestId": { "type": "string", "description": "The ID of the Nest that owns this name." }
      },
      "required": ["nestId"]
    },
    "friendRequest": {
      "title": "Friend Request",
      "description": "Represents one user's request to befriend another.",
      "type": "object",
      "properties": {
        "requestingUserId": { "type": "string", "description": "The UID of the user sending the request." },
        "requestingUsername": { "type": "string", "description": "The username of the user sending the request." },
        "status": { "type": "string", "enum": ["pending"], "description": "The status of the request." },
        "createdAt": { "type": "string", "format": "date-time", "description": "Timestamp of when the request was sent." }
      },
      "required": ["requestingUserId", "requestingUsername", "status", "createdAt"]
    },
    "friend": {
      "title": "Friend",
      "description": "Represents a friendship link between two users.",
      "type": "object",
      "properties": {
        "userId": { "type": "string", "description": "The UID of the friend." },
        "username": { "type": "string", "description": "The username of the friend." },
        "since": { "type": "string", "format": "date-time", "description": "Timestamp of when the friendship started." }
      },
      "required": ["userId", "username", "since"]
    }
  },
  "auth": {
    "providers": ["password"]
  },
  "firestore": {
     "/users/{userId}/achievements/{achievementId}": {
      "schema": { "$ref": "#/entities/achievement" },
      "description": "Stores individual achievement status for each user."
    },
    "/users/{userId}/stats/summary": {
      "schema": { "$ref": "#/entities/userStats" },
      "description": "Stores a summary of a user's game statistics. The document ID must be 'summary'."
    },
    "/users/{userId}/cosmetics/{cosmeticId}": {
      "schema": { "$ref": "#/entities/cosmetic" },
      "description": "Stores the cosmetic items a user has unlocked."
    },
     "/users/{userId}/conversations/{otherUserId}": {
      "schema": { "$ref": "#/entities/conversation" },
      "description": "A list of users that the parent user has DM conversations with."
    },
    "/users/{userId}/friend-requests/{requestingUserId}": {
      "schema": { "$ref": "#/entities/friendRequest" },
      "description": "Incoming friend requests for a user."
    },
    "/users/{userId}/friends/{friendId}": {
      "schema": { "$ref": "#/entities/friend" },
      "description": "A user's list of friends."
    },
    "/usernames/{username}": {
      "schema": { "$ref": "#/entities/username" },
      "description": "A collection where each document ID is a unique, lowercase username used for uniqueness checks."
    },
    "/nest-names/{nestName}": {
      "schema": { "$ref": "#/entities/nestName" },
      "description": "A collection where each document ID is a unique, lowercase Nest name used for uniqueness checks."
    },
    "/league-players/{userId}": {
        "schema": { "$ref": "#/entities/leaguePlayer" },
        "description": "Stores public-facing data for league leaderboards."
    },
    "/nests/{nestId}": {
      "schema": { "$ref": "#/entities/nest" },
      "description": "Stores all Nests (clans) created by players."
    },
    "/nests/{nestId}/members/{userId}": {
      "schema": { "$ref": "#/entities/nestMember" },
      "description": "Stores the members and their roles for a specific Nest."
    },
    "/nests/{nestId}/join-requests/{requestId}": {
      "schema": { "$ref": "#/entities/nestJoinRequest" },
      "description": "Stores requests from users who want to join this private Nest."
    },
    "/global-messages/{messageId}": {
      "schema": { "$ref": "#/entities/chatMessage" },
      "description": "Stores messages for the global chat."
    },
    "/nests/{nestId}/messages/{messageId}": {
      "schema": { "$ref": "#/entities/chatMessage" },
      "description": "Stores messages for a specific Nest's private chat."
    },
    "/dms/{channelId}/messages/{messageId}": {
      "schema": { "$ref": "#/entities/chatMessage" },
      "description": "Stores direct messages between players."
    }
  }
}